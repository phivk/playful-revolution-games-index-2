---
phase: 02-search-filter
plan: 01
type: execute
wave: 1
depends_on: [01-01]
files_modified: [src/hooks/useGameFilters.ts, src/components/FilterChips.tsx, src/components/SearchBar.tsx, src/components/RandomPicker.tsx, src/app/page.tsx, src/components/GameCard.tsx]
autonomous: true
requirements: [FILT-01, FILT-02, FILT-03, FILT-04, FILT-05]

must_haves:
  truths:
    - "Users can filter by one or more tags (AND logic)"
    - "Users can filter by pillars (Intellectual, Social, Physical)"
    - "Users can filter by energy level (Low, Medium, High)"
    - "Users can search by game name or keyword in description"
    - "Users can tap Surprise Me to get a random game suggestion"
    - "Filter UI shows chips organized by category with count badge"
    - "Empty state shows message when no games match"
    - "Clear all button resets all filters"
  artifacts:
    - path: "src/hooks/useGameFilters.ts"
      provides: "Filter state management with AND logic"
      exports: ["useGameFilters", "FilterState"]
    - path: "src/components/FilterChips.tsx"
      provides: "Filter chip components for tags, pillars, energy"
    - path: "src/components/SearchBar.tsx"
      provides: "Search input with instant search"
    - path: "src/components/RandomPicker.tsx"
      provides: "Surprise me button"
    - path: "src/app/page.tsx"
      provides: "Catalog with filters integrated"
  key_links:
    - from: "src/app/page.tsx"
      to: "src/hooks/useGameFilters.ts"
      via: "useGameFilters hook returns filtered games"
    - from: "src/hooks/useGameFilters.ts"
      to: "src/data/games.json"
      via: "filters games array using AND logic"
    - from: "src/components/RandomPicker.tsx"
      to: "src/app/game/[slug]/page.tsx"
      via: "router.push to random game slug"
---

<objective>
Add search, filter chips, and random picker functionality to the game catalog page.
</objective>

<context>
@.planning/PROJECT.md
@.planning/REQUIREMENTS.md
@.planning/phases/02-search-filter/02-CONTEXT.md
@playful_revolution_web_design_brief.md
@.planning/phases/01-core-display/01-01-PLAN.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create filter state management hook</name>
  <files>src/hooks/useGameFilters.ts</files>
  <action>
    Create useGameFilters hook with the following:
    
    - Define FilterState type with:
      - tags: string[] (selected tag values)
      - pillars: string[] (selected pillar values)
      - energyLevels: string[] (selected energy levels)
      - searchQuery: string
    
    - Implement filter logic:
      - AND combination: game must match ALL selected filters in each category
      - For tags/pillars/energy: game matches if ANY of its values intersect with selected
      - For search: case-insensitive match on title OR description
    
    - Export filtered games based on current state
    - Include clearAll() function to reset state
    
    Reference game type from src/types/game.ts (created in Phase 1).
  </action>
  <verify>
    TypeScript compiles without errors, hook exports FilterState and filteredGames
  </verify>
  <done>
    Filter hook manages state with AND logic, search works on title/description
  </done>
</task>

<task type="auto">
  <name>Task 2: Build filter UI components</name>
  <files>src/components/FilterChips.tsx, src/components/SearchBar.tsx, src/components/RandomPicker.tsx</files>
  <action>
    Create FilterChips component:
    - Three chip groups: Tags, Pillars, Energy Levels
    - Tags: Social Spontaneity, Group Circle Games, Collaborative, Competitive, Ball Games, Theatre Sports, Movement, Table Games
    - Pillars: Intellectual, Social, Physical
    - Energy: Low, Medium, High
    - Chip appearance: pill-shaped, unselected=outlined, selected=filled with bold color
    - Count badge next to each category label showing active filter count
    - Clear all button (appears when any filter active)
    
    Create SearchBar component:
    - Text input at top of page
    - Placeholder: "Search games..."
    - Instant search: filters as user types (debounced 150ms)
    - Clear button when query present
    
    Create RandomPicker component:
    - Button labeled "Surprise Me!"
    - On click: randomly select from ALL games (ignores current filters)
    - Navigate to selected game's detail page via router
    - Bold, eye-catching styling per design brief
  </action>
  <verify>
    Components render without errors, click handlers work
  </verify>
  <done>
    Filter chips, search bar, and surprise me button render and function
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate filters into catalog page</name>
  <files>src/app/page.tsx</files>
  <action>
    Update src/app/page.tsx to integrate all filter components:
    
    - Add SearchBar at top of page
    - Add FilterChips below search (always visible, not collapsed)
    - Add RandomPicker button (determine best placement - suggest near search)
    - Use useGameFilters hook to get filtered games
    - Show filtered games in existing GameCard grid
    - Add empty state: "No games match your filters" with suggestion to adjust
    - Keep existing catalog functionality (grid, scrolling)
    
    Styling per design brief:
    - Use brand colors for selected chips (Revolution Red, Play Green, Joy Yellow, Deep Blue)
    - Bold chip selection states
    - Responsive: chips wrap on mobile
    - High contrast, large tap targets
  </verify>
  <verify>
    - Search filters games by name/description instantly
    - Chips filter by tag/pillar/energy (AND logic)
    - Surprise Me navigates to random game
    - Empty state shows when no matches
    - Clear all resets filters
  </verify>
  <done>
    Full search/filter/random functionality integrated into catalog page
  </done>
</task>

</tasks>

<verification>
1. Search by game name returns matching games
2. Search by keyword in description returns matching games
3. Selecting tag chips filters to games with that tag
4. Selecting multiple tags uses AND logic
5. Selecting pillar chips filters by pillar
6. Selecting energy level chips filters by energy
7. Combined filters + search work together
8. Surprise Me navigates to random game page
9. Empty state shows when no games match filters
10. Clear all button resets all filters
</verification>

<success_criteria>
- [ ] FILT-01: Filter by tags works (8 tag options)
- [ ] FILT-02: Filter by pillars works (3 pillar options)
- [ ] FILT-03: Filter by energy level works (3 energy options)
- [ ] FILT-04: Search by name/keyword works
- [ ] FILT-05: Random picker navigates to random game
</success_criteria>

<output>
After completion, create `.planning/phases/02-search-filter/02-01-SUMMARY.md`
</output>
